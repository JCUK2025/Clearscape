<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ClearScape Financial Tracker</title>
    
    <link rel="icon" type="image/png" href="app_icon_192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="app_icon_512.png" sizes="512x512">
    <link rel="apple-touch-icon" href="apple_touch_icon.png">
    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
    <link rel="manifest" href="manifest.json">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>

    <section id="passwordLockView" class="page">
        <div class="logo-container" style="position: relative; margin-bottom: 20px;">
            <img id="lockScreenLogo" src="clearscape_logo.png" alt="App Logo" style="width: 150px;">
            <div id="seasonalDecorationLock"></div>
        </div>
        <h2 id="lockScreenTitle">Enter Password</h2>
        <input type="password" id="mainPasswordInput" placeholder="Password">
        <button id="unlockAppBtn">Unlock</button>
        <a href="#" id="forgotPasswordLink" style="margin-top: 15px; color: var(--dark-text); font-size: 0.9em;">Forgot Password?</a>
    </section>

    <section id="resetPasswordView" class="page" style="display: none;">
        <div id="securityQuestionStep">
            <h2>Password Reset</h2>
            <p>Please answer your security question.</p>
            <p id="securityQuestionText" class="security-question"></p>
            <input type="text" id="securityAnswerInput" placeholder="Your Answer">
            <button id="submitAnswerBtn">Submit Answer</button>
            <button id="backToLockScreenBtn">Cancel</button>
        </div>
        <div id="createNewPasswordStep" style="display: none;">
            <h2>Create New Password</h2>
            <p>Your answer was correct. Please set a new password.</p>
            <input type="password" id="newPasswordResetInput" placeholder="New Password">
            <input type="password" id="confirmNewPasswordResetInput" placeholder="Confirm New Password">
            <button id="saveNewPasswordBtn">Save New Password</button>
        </div>
    </section>

    <section id="splashScreen" class="page" style="display: none;">
        <div class="logo-container" style="position: relative;">
            <img id="appLogo" src="clearscape_logo.png" alt="App Logo" style="width: 180px;">
            <div id="seasonalDecoration"></div>
        </div>
        <h1 id="splashTitle" style="color: var(--primary-color);"></h1>
        <p id="factOfTheDay"></p>
        <div style="display: flex; flex-direction: column; gap: 15px; width: 80%; max-width: 300px; margin-top: 30px;">
            <button class="splash-btn" id="goToDataCentreBtn">Data Centre</button>
            <button class="splash-btn" id="goToNewTransactionBtn">New Transaction</button>
            <button class="splash-btn" id="goToTransactionsBtn">Transactions List</button>
            <button class="splash-btn" id="goToAnalyticsBtn">Analytics</button>
            <button class="splash-btn" id="goToQuotesBtn">Quotes</button>
            <button class="splash-btn" id="goToSettingsBtn">Settings</button>
        </div>
    </section>

    <section id="setupWizardView" class="page" style="display: none; text-align: center; padding: 20px 20px 50px 20px;">
        <div id="stepName" class="setup-step">
            <h2>Welcome! Let's Get Started</h2><p>First, what's your name?</p><input type="text" id="userNameInput" placeholder="Your Name" required><button id="nextStepName">Next →</button>
        </div>
        <div id="stepUserTitle" class="setup-step" style="display: none;">
            <h2>What should we call you?</h2>
            <p>Enter a title or nickname (e.g., Boss, Manager, or just your name again).</p>
            <input type="text" id="userTitleInput" placeholder="How you'd like to be addressed">
            <button id="backStepUserTitle">← Back</button>
            <button id="nextStepUserTitle">Next →</button>
        </div>
        <div id="stepBusinessName" class="setup-step" style="display: none;">
            <h2>What's your Business Name?</h2><p>This will be used as the title of your dashboard.</p><input type="text" id="businessNameInput" placeholder="e.g., John's Gardening" required><button id="backStepBusinessName">← Back</button><button id="nextStepBusinessName">Next →</button>
        </div>
        <div id="stepCurrency" class="setup-step" style="display: none;">
            <h2>Select Your Currency</h2><p>All financial values will be displayed with this currency.</p><select id="currencySetupSelect" style="display: block; width: 100%; max-width: 300px; margin: 0 auto 15px auto; padding: 10px;"><option value="GBP">British Pound (£)</option><option value="USD">US Dollar ($)</option><option value="EUR">Euro (€)</option></select><button id="backStepCurrency">← Back</button><button id="nextStepCurrency">Next →</button>
        </div>
        <div id="stepPassword" class="setup-step" style="display: none;">
            <h2>Create an App Password</h2><p>This password will protect your app on startup.</p><input type="password" id="passwordSetupInput" placeholder="Enter password (e.g., 0000)" required><button id="backStepPassword">← Back</button><button id="nextStepPassword">Next →</button>
        </div>
        <div id="stepSecurity" class="setup-step" style="display: none;">
            <h2>Set Security Questions</h2>
            <p>In case you forget your password, please set two security questions.</p>
            <div class="form-group"><select id="securityQuestion1"></select><input type="text" id="securityAnswer1" placeholder="Answer 1" required></div>
            <div class="form-group"><select id="securityQuestion2"></select><input type="text" id="securityAnswer2" placeholder="Answer 2" required></div>
            <button id="backStepSecurity">← Back</button><button id="nextStepSecurity">Next →</button>
        </div>
        <div id="stepBalance" class="setup-step" style="display: none;">
            <h2>Set Your Starting Balance</h2><p>Enter your current cash balance to ensure accurate tracking.</p><input type="number" id="balanceSetupInput" placeholder="e.g., 5000.00" step="0.01" required><button id="backStepBalance">← Back</button><button id="nextStepBalance">Next →</button>
        </div>
        <div id="stepCategories" class="setup-step" style="display: none;">
            <h2>Review Job Categories</h2><p>These are pre-filled based on business type. Add any others you need.</p>
            <div style="display: flex; justify-content: center; align-items: center; gap: 10px; max-width: 450px; margin: 0 auto;">
                <input type="text" id="categorySetupInput" placeholder="Add a custom category..." style="margin-bottom: 0;">
                <select id="categoryTypeSetupSelect" style="margin-bottom: 0; width: 120px;">
                    <option value="Sales">For Sale</option><option value="Expenses">For Expense</option><option value="Deposit">For Deposit</option><option value="Withdrawal">For Withdrawal</option><option value="Refund">For Refund</option>
                </select>
                <button id="addCategoryWizardBtn">Add</button>
            </div>
            <ul id="categoryWizardList" style="list-style: none; padding: 0; margin: 15px auto; max-width: 300px;"></ul><button id="backStepCategories">← Back</button><button id="finishSetupBtn">Finish Setup</button>
        </div>
    </section>

    <div id="appContainer" style="display: none;">
        <header>
            <button id="headerNewTransactionBtn">New Transaction</button>
            <h1 id="appNameHeader">ClearScape</h1>
            <div class="header-right-buttons">
                <button id="headerTransactionsBtn">Transactions</button>
                <button id="headerAnalyticsBtn">Analytics</button>
                <button id="headerDataCentreBtn">Data Centre</button>
                <button id="headerSettingsBtn">Settings</button>
            </div>
        </header>

        <main style="max-width: 1000px; margin: 0 auto; padding: 0 10px;">
            
            <section id="newTransactionView" class="app-view">
                </section>

            <section id="transactionListView" class="app-view">
                </section>

            <section id="dataCentreView" class="app-view">
                </section>

            <section id="settingsView" class="app-view">
                </section>
            
            <section id="analyticsView" class="app-view">
                </section>

        </main>
    </div>

    <script>
        if ('serviceWorker' in navigator) {
          window.addEventListener('load', function() {
            navigator.serviceWorker.register('service-worker.js').then(function(registration) {
              console.log('ServiceWorker registration successful with scope: ', registration.scope);
            }, function(err) {
              console.log('ServiceWorker registration failed: ', err);
            });
          });
        }
    </script>
    <script src="script.js"></script>
</body>
</html>