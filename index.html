<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ClearScape Financial Tracker</title>
    
    <link rel="icon" type="image/png" href="app_icon_192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="app_icon_512.png" sizes="512x512">
    <link rel="apple-touch-icon" href="apple_touch_icon.png">
    <link rel="manifest" href="manifest.json">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>

    <section id="splashScreen">
        <div id="logoContainer" style="position: relative;">
            <img id="appLogo" src="clearscape_logo.png" alt="App Logo" style="width: 150px;">
            <div id="seasonalDecoration"></div>
        </div>
        <h1 id="splashTitle" style="color: var(--primary-color);"></h1>
        <p id="factOfTheDay"></p>
        
        <div id="passwordLoginContainer">
            <input type="password" id="splashPasswordInput" placeholder="Enter Password">
            <button id="loginBtn">Unlock</button>
            <a href="#" id="forgotPasswordSplashLink">Forgot Password?</a>
        </div>
    
        <div id="splashMenuContainer" class="radial-menu hidden">
            <ul class="menu-items">
                <li class="menu-item" id="goToDashboardBtn">
                    <a href="#" title="Dashboard"><span>üìä</span></a>
                </li>
                <li class="menu-item" id="goToTransactionsBtn">
                    <a href="#" title="Transactions"><span>üßæ</span></a>
                </li>
                <li class="menu-item" id="goToSmartAnalysisBtn">
                    <a href="#" title="Analysis"><span>üìà</span></a>
                </li>
                <li class="menu-item" id="goToCalendarBtn">
                    <a href="#" title="Calendar"><span>üóìÔ∏è</span></a>
                </li>
                <li class="menu-item" id="goToSettingsBtn">
                    <a href="#" title="Settings"><span>‚öôÔ∏è</span></a>
                </li>
            </ul>
            <button id="menuToggleBtn" class="menu-toggle">
                <img src="clearscape_logo.png" alt="Menu">
            </button>
        </div>
    </section>

    <section id="setupWizardView" style="display: none; text-align: center; padding: 20px 20px 50px 20px;">
        <div id="stepName" class="setup-step">
            <h2>Welcome! Let's Get Started</h2><p>First, what's your name?</p><input type="text" id="userNameInput" placeholder="Your Name" required><button id="nextStepName">Next ‚Üí</button>
        </div>
        <div id="stepBusinessName" class="setup-step" style="display: none;">
            <h2>What's your Business Name?</h2><p>This will be used as the title of your dashboard.</p><input type="text" id="businessNameInput" placeholder="e.g., John's Gardening" required><button id="backStepBusinessName">‚Üê Back</button><button id="nextStepBusinessName">Next ‚Üí</button>
        </div>
        <div id="stepCompanyDetails" class="setup-step" style="display: none;">
            <h2>Enter Your Company Details</h2>
            <p>These will be used on your invoices and quotes.</p>
            <input type="text" id="companyAddressInput" placeholder="Address (e.g., 123 Green Lane, Belper)">
            <input type="tel" id="companyPhoneInput" placeholder="Phone Number">
            <input type="email" id="companyEmailInput" placeholder="Email Address">
            <input type="url" id="companyWebsiteInput" placeholder="Website / Social Media URL">
            <button id="backStepCompanyDetails">‚Üê Back</button>
            <button id="nextStepCompanyDetails">Next ‚Üí</button>
        </div>
        <div id="stepCurrency" class="setup-step" style="display: none;">
            <h2>Select Your Currency</h2><p>All financial values will be displayed with this currency.</p><select id="currencySetupSelect" style="display: block; width: 100%; max-width: 300px; margin: 0 auto 15px auto; padding: 10px;"><option value="GBP">British Pound (¬£)</option><option value="USD">US Dollar ($)</option><option value="EUR">Euro (‚Ç¨)</option></select><button id="backStepCurrency">‚Üê Back</button><button id="nextStepCurrency">Next ‚Üí</button>
        </div>
        <div id="stepPassword" class="setup-step" style="display: none;">
            <h2>Create a Settings Password</h2><p>This password will protect your settings menu.</p><input type="password" id="passwordSetupInput" placeholder="Enter password (e.g., 0000)" required><button id="backStepPassword">‚Üê Back</button><button id="nextStepPassword">Next ‚Üí</button>
        </div>
        <div id="stepSecurity" class="setup-step" style="display: none;">
            <h2>Set Up Security Questions</h2>
            <p>If you forget your password, you can answer these questions to reset it.</p>
            <div class="form-group" style="max-width: 350px; margin: 15px auto; text-align: left;">
                <label for="securityQ1">Question 1:</label>
                <select id="securityQ1">
                    <option>What was your first pet's name?</option>
                    <option>What is your mother's maiden name?</option>
                    <option>What was the name of your elementary school?</option>
                </select>
                <input type="text" id="securityA1" placeholder="Answer 1" required style="margin-top: 5px;">
            </div>
            <div class="form-group" style="max-width: 350px; margin: 15px auto; text-align: left;">
                <label for="securityQ2">Question 2:</label>
                <select id="securityQ2">
                    <option>In what city were you born?</option>
                    <option>What is the name of your favorite book?</option>
                    <option>What was the model of your first car?</option>
                </select>
                <input type="text" id="securityA2" placeholder="Answer 2" required style="margin-top: 5px;">
            </div>
            <button id="backStepSecurity">‚Üê Back</button>
            <button id="nextStepSecurity">Next ‚Üí</button>
        </div>
        <div id="stepBalance" class="setup-step" style="display: none;">
            <h2>Set Your Starting Balance</h2><p>Enter your current cash balance to ensure accurate tracking.</p><input type="number" id="balanceSetupInput" placeholder="e.g., 5000.00" step="0.01" required><button id="backStepBalance">‚Üê Back</button><button id="nextStepBalance">Next ‚Üí</button>
        </div>
        <div id="stepCategories" class="setup-step" style="display: none;">
            <h2>Review Job Categories</h2><p>These are pre-filled based on business type. Add any others you need.</p>
            <div class="form-group-inline">
                <input type="text" id="categorySetupInput" placeholder="Add custom category...">
                <select id="categoryTypeSetupSelect">
                    <option value="Sales">Sale</option>
                    <option value="Expenses">Expense</option>
                    <option value="Deposit">Deposit</option>
                    <option value="Withdrawal">Withdrawal</option>
                    <option value="Refund">Refund</option>
                </select>
                <button id="addCategoryWizardBtn">Add</button>
            </div>
            <ul id="categoryWizardList" style="list-style: none; padding: 0; margin: 15px auto; max-width: 300px;"></ul><button id="backStepCategories">‚Üê Back</button><button id="finishSetupBtn">Finish Setup</button>
        </div>
    </section>

    <div id="appContainer" style="display: none;">
        <header>
            <button id="viewSplashBtn">Home</button>
            <h1 id="appNameHeader">ClearScape</h1>
            <div class="header-right-buttons">
                <button id="headerTransactionsBtn">Transactions</button>
                <button id="headerAnalyticsBtn">Analytics</button>
                <button id="headerSmartAnalysisBtn">Smart Analysis</button>
                <button id="headerCalendarBtn">Calendar</button>
                <button id="headerSettingsBtn">Settings</button>
            </div>
        </header>

        <main style="max-width: 1000px; margin: 0 auto; padding: 0 10px;">
            
            <section id="dashboardView" class="app-view">
                <div id="smartInsightsBox" class="analytics-section" style="margin-top: 20px; border-left: 5px solid var(--primary-color);">
                    <h3 style="margin-top: 0; font-size: 1.1em;">Smart Insights üí°</h3>
                    <ul id="insightsList"></ul>
                </div>
                <div class="summary-cards-container" style="margin-top: 20px;">
                    <div id="salesCard" class="summary-card">
                        <h3>Total Sales Revenue</h3><p id="totalSales" class="amount positive">¬£0.00</p>
                        <div class="card-details"><p>A breakdown of sales will show here.</p></div>
                    </div>
                    <div id="outflowCard" class="summary-card">
                        <h3>Total Outflow</h3><p id="totalOutflow" class="amount negative">¬£0.00</p>
                        <div class="card-details"><p>A breakdown of outflow will show here.</p></div>
                    </div>
                    <div id="balanceCard" class="summary-card">
                        <h3>Outstanding Balance</h3><p id="outstandingBalance" class="amount balance">¬£0.00</p><span class="sub-text">(Cash Flow)</span>
                        <div class="card-details"><p>Details about your balance.</p></div>
                    </div>
                    <div id="arCard" class="summary-card">
                        <h3>Total Outstanding (A/R)</h3><p id="totalOutstanding" class="amount negative">¬£0.00</p>
                        <div class="card-details"><p>Details about accounts receivable.</p></div>
                    </div>
                </div>
                <div class="transaction-form-container">
                    <h2>Add New Transaction</h2>
                    <form id="transactionForm" class="transaction-form-grid">
                        <div class="form-group"><label for="transactionNumberDisplay">Transaction Number</label><input type="text" id="transactionNumberDisplay" disabled></div>
                        <div class="form-group"><label for="transactionDate">Date</label><input type="date" id="transactionDate" required></div>
                        <div class="form-group"><label for="transactionName">Name / Description</label>
                            <input type="text" id="transactionName" list="clientDatalist" placeholder="Select or type a client name..." required>
                            <datalist id="clientDatalist"></datalist>
                        </div>
                        <div class="form-group"><label for="transactionTypeSelect">Type of Transaction</label>
                            <select id="transactionTypeSelect" required>
                                <option value="Sale">Sale</option><option value="Expense">Expense</option><option value="Deposit">Deposit</option><option value="Withdrawal">Withdrawal</option><option value="Refund">Refund</option>
                            </select>
                        </div>
                        <div class="form-group"><label for="jobTypeSelect">Job Type / Category</label><select id="jobTypeSelect" required></select></div>
                        <div class="form-group"><label for="amountDueInput">Amount Due / Total Value</label><input type="number" id="amountDueInput" placeholder="100.00" step="0.01" required></div>
                        <div id="amountPaidGroup" class="form-group"><label for="amountPaidInput">Amount Paid / Transacted Now</label><input type="number" id="amountPaidInput" placeholder="100.00" step="0.01" required></div>
                        <div class="form-group full-width" style="border-top: 1px solid #ddd; padding-top: 15px;">
                            <div class="checkbox-group">
                                <input type="checkbox" id="isRecurringCheckbox"><label for="isRecurringCheckbox">Is this a Recurring Transaction?</label>
                            </div>
                            <div id="recurringOptions" style="display: none; margin-top: 10px; padding: 10px; background-color: #e9e9e9; border-radius: 5px;">
                                <div class="form-group"><label for="recurringFrequency">Frequency:</label>
                                    <select id="recurringFrequency">
                                        <option value="Weekly">Weekly</option><option value="Monthly">Monthly</option><option value="Quarterly">Quarterly</option><option value="Yearly">Yearly</option>
                                    </select>
                                </div>
                                <div class="form-group"><label>Repetitions:</label>
                                    <div><input type="radio" id="repeatForever" name="repeatOption" value="forever" checked><label for="repeatForever">Repeat Forever</label></div>
                                    <div style="margin-top: 5px;"><input type="radio" id="repeatCount" name="repeatOption" value="count"><label for="repeatCount">Repeat for</label><input type="number" id="repetitionCount" min="1" value="12" style="width: 70px; padding: 5px;" disabled><label for="repetitionCount">times</label></div>
                                </div>
                            </div>
                        </div>
                        <div class="form-group full-width"><label for="jobNotesInput">Notes</label><textarea id="jobNotesInput" placeholder="Detailed notes for this transaction..."></textarea></div>
                        <input type="hidden" id="transactionId"><button type="submit" id="addTransactionBtn" class="full-width">Add Transaction</button>
                    </form>
                </div>
            </section>

            <section id="transactionListView" class="app-view">
                <button id="backToDashboardBtn">‚Üê Back to Dashboard</button>
                <h2>All Transactions</h2>
                <div id="filterControls" class="analytics-section">
                    <h3 style="margin-top: 0;">Filters & Search</h3>
                    <input type="text" id="transactionSearchInput" placeholder="Search by name or notes..." style="width: 100%; max-width: 300px; padding: 8px; margin-bottom: 10px;">
                    <label for="filterTransactionType">Type:</label>
                    <select id="filterTransactionType" style="margin-right: 20px; padding: 8px;">
                        <option value="">All Types</option><option value="Sale">Sale</option><option value="Expense">Expense</option><option value="Deposit">Deposit</option><option value="Withdrawal">Withdrawal</option><option value="Refund">Refund</option>
                    </select>
                    <label for="filterJobType">Category:</label>
                    <select id="filterJobType" style="margin-right: 20px; padding: 8px;"><option value="">All Categories</option></select>
                    <label for="filterPaidStatus">Status:</label>
                    <select id="filterPaidStatus" style="margin-right: 20px; padding: 8px;"><option value="">All Statuses</option><option value="Outstanding">Outstanding Balance</option><option value="Paid">Fully Paid</option></select>
                    <label for="filterStartDate">From:</label><input type="date" id="filterStartDate" style="margin-right: 20px; padding: 8px;">
                    <label for="filterEndDate">To:</label><input type="date" id="filterEndDate" style="margin-right: 20px; padding: 8px;">
                    <button id="applyFiltersBtn" style="padding: 8px 15px;">Apply Filters</button>
                    <button id="resetFiltersBtn" style="padding: 8px 15px;">Reset</button>
                    <button id="exportCsvBtn" style="padding: 8px 15px; margin-left: 10px;">Download CSV</button>
                </div>
                <ul id="fullTransactionList"></ul>
            </section>

            <section id="settingsView" class="app-view">
                <button id="backToDashboardFromSettingsBtn">‚Üê Back to Dashboard</button>
                <h2>Application Settings</h2>
                <div id="actualSettings">
                    <div class="analytics-section">
                        <h4>üé® Branding & Theme</h4>
                        <div class="form-group">
                            <label for="businessNameSetting">Business Name</label>
                            <input type="text" id="businessNameSetting">
                            <button id="saveBusinessNameBtn" style="margin-top: 5px;">Save Name</button>
                        </div>
                    </div>
                     <div class="analytics-section">
                        <h4>üè¢ Company Details</h4>
                        <p style="font-size: 0.9em;">Edit the contact information that appears on your invoices.</p>
                        <div class="form-group">
                            <label for="companyAddressSetting">Address</label>
                            <input type="text" id="companyAddressSetting">
                        </div>
                        <div class="form-group">
                            <label for="companyPhoneSetting">Phone</label>
                            <input type="tel" id="companyPhoneSetting">
                        </div>
                        <div class="form-group">
                            <label for="companyEmailSetting">Email</label>
                            <input type="email" id="companyEmailSetting">
                        </div>
                        <div class="form-group">
                            <label for="companyWebsiteSetting">Website / Social Media</label>
                            <input type="url" id="companyWebsiteSetting">
                        </div>
                        <button id="saveCompanyDetailsBtn" style="margin-top: 10px;">Save Details</button>
                    </div>
                     <div class="analytics-section">
                        <h4>üìÇ Job Categories</h4>
                        <p style="font-size: 0.9em;">Add or remove custom job categories for transaction entry.</p>
                        <button id="manageCategoriesBtn">Manage Categories</button>
                    </div>
                    <div class="analytics-section">
                        <h4>üë• Client Management</h4>
                        <p style="font-size: 0.9em;">Add your regular clients here for faster transaction entry.</p>
                        <div class="form-group">
                            <label for="clientNameInput">New Client Name</label>
                            <input type="text" id="clientNameInput" placeholder="Enter client's name">
                            <button id="addClientBtn" style="margin-top: 5px;">Add Client</button>
                        </div>
                        <hr style="margin: 20px 0;">
                        <h5>Your Clients:</h5>
                        <ul id="clientList" style="list-style: none; padding: 0;"></ul>
                    </div>
                    <div class="analytics-section">
                        <h4>üíæ Data Backup & Restore</h4>
                        <p style="font-size: 0.9em;">Export all your app data to a JSON file as a backup. You can import this file later to restore your data.</p>
                        <button id="exportDataBtn">Export Data</button>
                        <button id="importDataBtn">Import Data</button>
                        <input type="file" id="importFileInput" accept=".json" style="display: none;">
                    </div>
                    <div class="analytics-section">
                        <h4>‚öôÔ∏è Security & Reset</h4>
                        <p style="font-size: 0.9em;"><strong>Danger Zone:</strong> Resetting will permanently delete all transactions, settings, and personal data.</p>
                        <button id="resetAppBtn">Reset All Application Data</button>
                    </div>
                </div>
            </section>

            <section id="categoryView" class="app-view">
                <button id="backToSettingsFromCategoryBtn">‚Üê Back to Settings</button>
                <h2>Manage Job Categories</h2>
                <div class="form-group-inline">
                    <input type="text" id="newCategoryInput" placeholder="Enter new category name">
                    <select id="newCategoryTypeSelect">
                        <option value="Sales">Sale</option>
                        <option value="Expenses">Expense</option>
                        <option value="Deposit">Deposit</option>
                        <option value="Withdrawal">Withdrawal</option>
                        <option value="Refund">Refund</option>
                    </select>
                    <button id="addCategoryBtn">Add Category</button>
                </div>
                <ul id="categoryList" style="margin-top: 20px; max-width: 480px; margin-left: auto; margin-right: auto; padding:0;"></ul>
            </section>
            
            <section id="analyticsView" class="app-view">
                <button id="backToDashboardFromAnalyticsBtn">‚Üê Back to Dashboard</button>
                <h2>Business Analytics</h2>
                <div class="analytics-section">
                    <label for="analyticsYearSelect" style="font-weight: bold;">Select Year:</label>
                    <select id="analyticsYearSelect" style="padding: 8px;"></select>
                </div>
                <div class="summary-cards-container">
                    <div class="summary-card">
                        <h3>Total Revenue</h3><p id="analyticsTotalRevenue" class="amount positive">¬£0.00</p>
                        <div class="card-details"><p>Details for the selected year.</p></div>
                    </div>
                    <div class="summary-card">
                        <h3>Total Expenses</h3><p id="analyticsTotalExpenses" class="amount negative">¬£0.00</p>
                        <div class="card-details"><p>Details for the selected year.</p></div>
                    </div>
                    <div class="summary-card">
                        <h3>Net Profit</h3><p id="analyticsNetProfit" class="amount balance">¬£0.00</p>
                        <div class="card-details"><p>Details for the selected year.</p></div>
                    </div>
                </div>
                <div class="analytics-section">
                    <h3 style="margin-top: 0;">Monthly Performance</h3>
                    <div class="chart-container" style="position: relative; height: 40vh; width: 100%;"><canvas id="monthlyChart"></canvas></div>
                </div>
            </section>

            <section id="smartAnalysisView" class="app-view">
                <button id="backToDashboardFromSmartAnalysisBtn">‚Üê Back to Dashboard</button>
                <h2>Smart Analysis üìä</h2>
                <div class="summary-cards-container">
                    <div class="summary-card"><h3>Busiest Month</h3><p id="kpiBusiestMonth" class="kpi-value">--</p><span class="sub-text">By transaction volume</span><div class="card-details"><p>Detailed transaction counts.</p></div></div>
                    <div class="summary-card"><h3>Avg. Sale Value</h3><p id="kpiAvgSaleValue" class="kpi-value">¬£0.00</p><span class="sub-text">For this year</span><div class="card-details"><p>Detailed transaction counts.</p></div></div>
                    <div class="summary-card"><h3>Top Expense</h3><p id="kpiTopExpense" class="kpi-value">--</p><span class="sub-text">Category this year</span><div class="card-details"><p>Detailed transaction counts.</p></div></div>
                    <div class="summary-card"><h3>Profit Margin</h3><p id="kpiProfitMargin" class="kpi-value">0%</p><span class="sub-text">For this year</span><div class="card-details"><p>Detailed transaction counts.</p></div></div>
                </div>
                <div class="analytics-section"><h3 style="margin-top: 0;">Yearly Performance Trends</h3><div class="chart-container" style="height: 40vh;"><canvas id="yearlyTrendChart"></canvas></div></div>
                <div class="smart-analysis-grid">
                    <div class="analytics-section"><h3 style="margin-top: 0;">Monthly Deep Dive</h3><div class="chart-filters"><select id="monthlyDeepDiveYearSelect"></select><select id="monthlyDeepDiveMonthSelect"></select></div><div class="chart-container" style="height: 40vh;"><canvas id="monthlyBarChart"></canvas></div></div>
                    <div class="analytics-section"><h3 style="margin-top: 0;">Expense Breakdown</h3> <p id="expenseBreakdownTitle" style="font-weight: bold; color: var(--dark-text);">For month of --</p><div class="chart-container" style="height: 40vh; display: flex; align-items: center; justify-content: center;"><canvas id="expenseDoughnutChart"></canvas></div></div>
                </div>
                <div class="analytics-section"><h3 style="margin-top: 0;">Top Clients by Revenue (This Year)</h3><ol id="clientLeaderboardList"></ol></div>
            </section>

            <section id="calendarView" class="app-view">
                <button id="backToDashboardFromCalendarBtn">‚Üê Back to Dashboard</button>
                <h2>Calendar & Reminders üóìÔ∏è</h2>
                <div class="calendar-container">
                    <div class="calendar-header"><button id="prevMonthBtn">‚óÄ</button><h3 id="monthAndYear"></h3><button id="nextMonthBtn">‚ñ∂</button></div>
                    <div class="calendar-grid-header"><div>Sun</div><div>Mon</div><div>Tue</div><div>Wed</div><div>Thu</div><div>Fri</div><div>Sat</div></div>
                    <div id="calendar-days" class="calendar-grid"></div>
                </div>
                <div class="reminders-section">
                    <h3>Reminders for <span id="selectedDateHeader">Today</span></h3>
                    <ul id="reminderList"></ul>
                    <div class="analytics-section">
                        <h4>Add New Reminder</h4>
                        <form id="addReminderForm">
                            <div class="form-group"><label for="reminderText">Reminder Note</label><input type="text" id="reminderText" placeholder="e.g., Follow up with John Smith" required></div>
                            <div class="form-group"><label for="reminderDate">Date</label><input type="date" id="reminderDate" required></div>
                            <button type="submit">Add Reminder</button>
                        </form>
                    </div>
                </div>
            </section>

        </main>
    </div>

    <div id="forgotPasswordModal" class="modal-overlay hidden">
        <div class="modal-content">
            <button class="modal-close-btn">&times;</button>
            <h2>Password Reset</h2>
            <p>Please answer your security questions to reset your password.</p>
            <div id="securityQuestionsContainer"></div>
            <button id="checkAnswersBtn">Check Answers</button>
            <div id="newPasswordContainer" class="hidden">
                <hr>
                <p>Success! Please enter a new password.</p>
                <input type="password" id="newPasswordResetInput" placeholder="New Password">
                <button id="saveNewPasswordBtn">Save New Password</button>
            </div>
        </div>
    </div>
    
    <div id="invoice-container" style="position: absolute; left: -9999px; top: auto; width: 210mm; font-family: Arial, sans-serif; color: #333; background: white;">
        <div style="padding: 10mm;">
            <div style="display: flex; justify-content: space-between; align-items: flex-start; border-bottom: 2px solid #4CAF50; padding-bottom: 20px;">
                <div>
                    <img id="invoice-logo" src="clearscape_logo.png" alt="ClearScape Logo" style="max-width: 150px; height: auto; margin-bottom: 10px; display: block;">
                    <h1 id="invoice-business-name" style="color: #4CAF50; margin: 0; font-size: 2.5em;">Business Name</h1>
                    <p id="invoice-company-details" style="margin: 5px 0 0 0; white-space: pre-line;"></p>
                </div>
                <div>
                    <h2 id="invoice-title" style="margin: 0; text-align: right; color: #333;">INVOICE</h2>
                    <p style="text-align: right; margin: 5px 0 0 0;"><strong>Invoice #:</strong> <span id="invoice-number"></span></p>
                    <p style="text-align: right; margin: 5px 0 0 0;"><strong>Date:</strong> <span id="invoice-date"></span></p>
                </div>
            </div>
            <div style="margin-top: 30px;"><p style="margin: 0;"><strong>Bill To:</strong></p><p id="invoice-client-name" style="margin: 5px 0 0 0;">Client Name</p></div>
            <table style="width: 100%; border-collapse: collapse; margin-top: 30px;">
                <thead style="background-color: #e8f5e9;"><tr><th style="padding: 10px; text-align: left; border-bottom: 1px solid #ddd;">Description</th><th style="padding: 10px; text-align: right; border-bottom: 1px solid #ddd;">Total</th></tr></thead>
                <tbody id="invoice-items"></tbody>
            </table>
            <div style="margin-top: 30px; text-align: right;">
                <p style="margin: 5px 0;"><strong>Amount Due:</strong> <span id="invoice-amount-due"></span></p>
                <p style="margin: 5px 0;"><strong>Amount Paid:</strong> <span id="invoice-amount-paid"></span></p>
                <h3 style="margin: 10px 0; color: #4CAF50;">Balance Due: <span id="invoice-balance-due"></span></h3>
            </div>
            <div style="margin-top: 50px; border-top: 1px solid #eee; padding-top: 15px;"><p style="font-size: 0.9em;"><strong>Notes:</strong></p><p id="invoice-notes" style="font-size: 0.9em;"></p></div>
        </div>
    </div>

    <script>
        if ('serviceWorker' in navigator) {
          window.addEventListener('load', function() {
            navigator.serviceWorker.register('service-worker.js').then(function(registration) {
              console.log('ServiceWorker registration successful with scope: ', registration.scope);
            }, function(err) {
              console.log('ServiceWorker registration failed: ', err);
            });
          });
        }
    </script>
    <script src="https://cdn.jsdelivr.net/npm/sortablejs@latest/Sortable.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="script.js"></script>
</body>
</html>